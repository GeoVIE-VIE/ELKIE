# Cowrie LLM Responder Configuration
# High-Interaction SSH Honeypot with Local LLM

server:
  # SSH honeypot port (redirect real SSH traffic here)
  ssh_port: 8022
  telnet_port: 8023

  # Fake system identity
  hostname: "ubuntu-server-01"
  os_name: "Ubuntu 22.04.3 LTS"
  kernel: "5.15.0-91-generic"

  # Session limits
  max_sessions: 100
  session_timeout: 300  # 5 minutes
  max_commands_per_session: 500

llm:
  # Ollama configuration
  host: "http://ollama:11434"

  # Model selection - optimized for CPU inference
  # Options (sorted by speed on CPU):
  #   - phi:2.7b              (fastest, ~4GB RAM)
  #   - neural-chat:7b-v3.3   (good balance)
  #   - mistral:7b-instruct   (best quality, ~8GB RAM)
  #   - llama2:13b            (highest quality, ~16GB RAM)
  model: "mistral:7b-instruct-v0.2-q4_K_M"

  # Generation parameters
  max_tokens: 512
  temperature: 0.7
  top_p: 0.9

  # Performance tuning for Xeon Platinum 8168
  # With 48 cores, we can handle multiple parallel requests
  num_parallel: 4
  timeout: 60

  # Response caching (reduces LLM calls for common commands)
  cache:
    enabled: true
    ttl: 3600  # 1 hour
    max_size: 10000

  # Rate limiting per session
  rate_limit:
    requests_per_minute: 30
    burst: 10

credentials:
  # Credentials that will allow login (intentionally weak)
  # Format: username: [password1, password2, ...]
  root:
    - "root"
    - "toor"
    - "password"
    - "123456"
    - "admin"
    - ""
  admin:
    - "admin"
    - "password"
    - "123456"
    - "admin123"
  user:
    - "user"
    - "password"
    - "123456"
  ubuntu:
    - "ubuntu"
    - "password"
  pi:
    - "raspberry"
    - "pi"
  oracle:
    - "oracle"
  postgres:
    - "postgres"
  mysql:
    - "mysql"
  test:
    - "test"
    - "test123"
  guest:
    - "guest"
    - ""

logging:
  # Log output path
  path: "/var/log/cowrie-llm"

  # Log level: DEBUG, INFO, WARNING, ERROR
  level: "INFO"

  # Elasticsearch integration (optional)
  elasticsearch:
    enabled: false
    host: "localhost:9200"
    index: "honeypot-llm"

  # Log format
  format: "json"  # json or text

# Fake filesystem structure
filesystem:
  root_home: "/root"
  default_shell: "/bin/bash"

  # Directories that will appear to exist
  directories:
    - "/root"
    - "/root/.ssh"
    - "/home"
    - "/var/log"
    - "/var/www/html"
    - "/etc/ssh"
    - "/tmp"

  # Files that will appear to exist
  files:
    - "/etc/passwd"
    - "/etc/shadow"
    - "/etc/hosts"
    - "/root/.bashrc"
    - "/root/.bash_history"

# Behavioral settings
behavior:
  # Delay responses slightly to seem more realistic
  min_response_delay: 0.1  # seconds
  max_response_delay: 0.5

  # Commands to block (return error)
  blocked_commands:
    - "rm -rf /"
    - "mkfs"
    - ":(){:|:&};:"  # Fork bomb

  # Commands to always allow (use static responses)
  static_commands:
    - "whoami"
    - "id"
    - "pwd"
    - "hostname"
    - "uname"
    - "date"

  # Simulate command execution time
  simulate_execution_time: true
